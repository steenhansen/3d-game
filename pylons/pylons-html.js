document.getElementById('pylon-html').innerHTML = `
<div id="pylon-exit"></div>
<div id="pylon-start"></div>

<div id="pylon-A-0"></div>
<div id="pylon-A-1"></div>
<div id="pylon-A-2"></div>
<div id="pylon-A-3"></div>
<div id="pylon-A-4"></div>
<div id="pylon-A-5"></div>
<div id="pylon-A-6"></div>
<div id="pylon-A-7"></div>
<div id="pylon-A-8"></div>
<div id="pylon-A-9"></div>
<div id="pylon-A-10"></div>
<div id="pylon-A-11"></div>
<div id="pylon-A-12"></div>
<div id="pylon-A-13"></div>
<div id="pylon-A-14"></div>
<div id="pylon-A-15"></div>
<div id="pylon-A-16"></div>
<div id="pylon-A-17"></div>
<div id="pylon-A-18"></div>
<div id="pylon-A-19"></div>
<div id="pylon-A-20"></div>
<div id="pylon-A-21"></div>
<div id="pylon-A-22"></div>
<div id="pylon-A-23"></div>
<div id="pylon-A-24"></div>
<div id="pylon-A-25"></div>
<div id="pylon-A-26"></div>
<div id="pylon-A-27"></div>
<div id="pylon-A-28"></div>
<div id="pylon-A-29"></div>
<div id="pylon-A-30"></div>
<div id="pylon-A-31"></div>

<div id="pylon-B-0"></div>
<div id="pylon-B-1"></div>
<div id="pylon-B-2"></div>
<div id="pylon-B-3"></div>
<div id="pylon-B-4"></div>
<div id="pylon-B-5"></div>
<div id="pylon-B-6"></div>
<div id="pylon-B-7"></div>
<div id="pylon-B-8"></div>
<div id="pylon-B-9"></div>
<div id="pylon-B-10"></div>
<div id="pylon-B-11"></div>
<div id="pylon-B-12"></div>
<div id="pylon-B-13"></div>
<div id="pylon-B-14"></div>
<div id="pylon-B-15"></div>
<div id="pylon-B-16"></div>
<div id="pylon-B-17"></div>
<div id="pylon-B-18"></div>
<div id="pylon-B-19"></div>
<div id="pylon-B-20"></div>
<div id="pylon-B-21"></div>
<div id="pylon-B-22"></div>
<div id="pylon-B-23"></div>
<div id="pylon-B-24"></div>
<div id="pylon-B-25"></div>
<div id="pylon-B-26"></div>
<div id="pylon-B-27"></div>
<div id="pylon-B-28"></div>
<div id="pylon-B-29"></div>
<div id="pylon-B-30"></div>
<div id="pylon-B-31"></div>

<div id="pylon-C-0"></div>
<div id="pylon-C-1"></div>
<div id="pylon-C-2"></div>
<div id="pylon-C-3"></div>
<div id="pylon-C-4"></div>
<div id="pylon-C-5"></div>
<div id="pylon-C-6"></div>
<div id="pylon-C-7"></div>
<div id="pylon-C-8"></div>
<div id="pylon-C-9"></div>
<div id="pylon-C-10"></div>
<div id="pylon-C-11"></div>
<div id="pylon-C-12"></div>
<div id="pylon-C-13"></div>
<div id="pylon-C-14"></div>
<div id="pylon-C-15"></div>
<div id="pylon-C-16"></div>
<div id="pylon-C-17"></div>
<div id="pylon-C-18"></div>
<div id="pylon-C-19"></div>
<div id="pylon-C-20"></div>
<div id="pylon-C-21"></div>
<div id="pylon-C-22"></div>
<div id="pylon-C-23"></div>
<div id="pylon-C-24"></div>
<div id="pylon-C-25"></div>
<div id="pylon-C-26"></div>
<div id="pylon-C-27"></div>
<div id="pylon-C-28"></div>
<div id="pylon-C-29"></div>
<div id="pylon-C-30"></div>
<div id="pylon-C-31"></div>

<div id="pylon-D-0"></div>
<div id="pylon-D-1"></div>
<div id="pylon-D-2"></div>
<div id="pylon-D-3"></div>
<div id="pylon-D-4"></div>
<div id="pylon-D-5"></div>
<div id="pylon-D-6"></div>
<div id="pylon-D-7"></div>
<div id="pylon-D-8"></div>
<div id="pylon-D-9"></div>
<div id="pylon-D-10"></div>
<div id="pylon-D-11"></div>
<div id="pylon-D-12"></div>
<div id="pylon-D-13"></div>
<div id="pylon-D-14"></div>
<div id="pylon-D-15"></div>
<div id="pylon-D-16"></div>
<div id="pylon-D-17"></div>
<div id="pylon-D-18"></div>
<div id="pylon-D-19"></div>
<div id="pylon-D-20"></div>
<div id="pylon-D-21"></div>
<div id="pylon-D-22"></div>
<div id="pylon-D-23"></div>
<div id="pylon-D-24"></div>
<div id="pylon-D-25"></div>
<div id="pylon-D-26"></div>
<div id="pylon-D-27"></div>
<div id="pylon-D-28"></div>
<div id="pylon-D-29"></div>
<div id="pylon-D-30"></div>
<div id="pylon-D-31"></div>

<div id="pylon-E-0"></div>
<div id="pylon-E-1"></div>
<div id="pylon-E-2"></div>
<div id="pylon-E-3"></div>
<div id="pylon-E-4"></div>
<div id="pylon-E-5"></div>
<div id="pylon-E-6"></div>
<div id="pylon-E-7"></div>
<div id="pylon-E-8"></div>
<div id="pylon-E-9"></div>
<div id="pylon-E-10"></div>
<div id="pylon-E-11"></div>
<div id="pylon-E-12"></div>
<div id="pylon-E-13"></div>
<div id="pylon-E-14"></div>
<div id="pylon-E-15"></div>
<div id="pylon-E-16"></div>
<div id="pylon-E-17"></div>
<div id="pylon-E-18"></div>
<div id="pylon-E-19"></div>
<div id="pylon-E-20"></div>
<div id="pylon-E-21"></div>
<div id="pylon-E-22"></div>
<div id="pylon-E-23"></div>
<div id="pylon-E-24"></div>
<div id="pylon-E-25"></div>
<div id="pylon-E-26"></div>
<div id="pylon-E-27"></div>
<div id="pylon-E-28"></div>
<div id="pylon-E-29"></div>
<div id="pylon-E-30"></div>
<div id="pylon-E-31"></div>

<div id="pylon-F-0"></div>
<div id="pylon-F-1"></div>
<div id="pylon-F-2"></div>
<div id="pylon-F-3"></div>
<div id="pylon-F-4"></div>
<div id="pylon-F-5"></div>
<div id="pylon-F-6"></div>
<div id="pylon-F-7"></div>
<div id="pylon-F-8"></div>
<div id="pylon-F-9"></div>
<div id="pylon-F-10"></div>
<div id="pylon-F-11"></div>
<div id="pylon-F-12"></div>
<div id="pylon-F-13"></div>
<div id="pylon-F-14"></div>
<div id="pylon-F-15"></div>
<div id="pylon-F-16"></div>
<div id="pylon-F-17"></div>
<div id="pylon-F-18"></div>
<div id="pylon-F-19"></div>
<div id="pylon-F-20"></div>
<div id="pylon-F-21"></div>
<div id="pylon-F-22"></div>
<div id="pylon-F-23"></div>
<div id="pylon-F-24"></div>
<div id="pylon-F-25"></div>
<div id="pylon-F-26"></div>
<div id="pylon-F-27"></div>
<div id="pylon-F-28"></div>
<div id="pylon-F-29"></div>
<div id="pylon-F-30"></div>
<div id="pylon-F-31"></div>
 `;

function drawPylons(the_player, the_pylons) {
  changed_pylons = [];
  // console.log("drawPylons", the_pylons);
  number_pylons = the_pylons.length;
  for (let pylon_index = 0; pylon_index < number_pylons; pylon_index++) {
    a_pylon = the_pylons[pylon_index];
    pylonSet(the_player, a_pylon);
    if (a_pylon.t_pylon_hit_flash > 0) {
      a_pylon.t_pylon_hit_flash--;
    } else {
      delete a_pylon.t_pylon_hit_flash;
    }
    changed_pylons[pylon_index] = a_pylon;

  }
  return changed_pylons;
}

function pylonFront(pylon_vlines, front_panel_id, outline_color, do_flash, difference_yy, poly_fill, pylon_type, vert_text, pylon_alive) {
  let [left_vline, middle_vline, _right_vline] = pylon_vlines;
  let [left_front_top, left_front_bot] = left_vline;
  let [right_front_top, right_front_bot] = middle_vline;
  left_right_tops_bots = [left_front_top, right_front_top, left_front_bot, right_front_bot];
  let front_pylon = pylonPolygon(left_right_tops_bots, front_panel_id, outline_color, do_flash, difference_yy, poly_fill, pylon_type, vert_text, pylon_alive);
  return front_pylon;
}

function pylonPolygon(a_polygon, panel_id, outline_color, do_flash, difference_yy, poly_fill, pylon_type, vert_text, pylon_alive) {
  if (pylon_alive) {
    fill_color = poly_fill;
  } else {
    fill_color = 'black';
  }
  if (pylon_type == 'is-pylon-sign') {
    svg_panel = signPylon(a_polygon, vert_text, fill_color);
  } else {
    svg_panel = pylonSide(a_polygon, fill_color, panel_id, pylon_alive);
  }
  if (do_flash) {
    svg_outlines = outlineFlash(a_polygon, panel_id);
  } else if (!pylon_alive && pylon_type == 'is-pylon') {
    svg_outlines = pylonOutline(a_polygon, panel_id, difference_yy, "grey");

  } else if (outline_color) {
    svg_outlines = pylonOutline(a_polygon, panel_id, difference_yy, outline_color);
  }
  svg_polygon = svg_outlines + svg_panel;
  return svg_polygon;
}

function pylonOutline(a_polygon, panel_id, difference_yy, outline_color) {
  outline_width = outlineWidth(difference_yy);
  let [left_front_top, right_front_top, left_front_bot, right_front_bot] = a_polygon;
  let [top_left_x, top_left_y] = left_front_top;
  let [top_right_x, top_right_y] = right_front_top;
  let [bot_left_x, bot_left_y] = left_front_bot;
  let [bot_right_x, bot_right_y] = right_front_bot;
  svg_outlines = `<polygon fill="none"  id="${panel_id}" stroke="${outline_color}"
      stroke-width="${outline_width}px"
                      points="${top_left_x},${top_left_y}
                              ${top_right_x},${top_right_y}
                              ${bot_right_x},${bot_right_y}
                              ${bot_left_x},${bot_left_y}      " />`;
  return svg_outlines;
}

function outlineFlash(a_polygon, panel_id) {
  let [left_front_top, right_front_top, left_front_bot, right_front_bot] = a_polygon;
  let [top_left_x, top_left_y] = left_front_top;
  let [top_right_x, top_right_y] = right_front_top;
  let [bot_left_x, bot_left_y] = left_front_bot;
  let [bot_right_x, bot_right_y] = right_front_bot;
  svg_outlines = `<polygon   id="${panel_id}" stroke="white" fill="none"
         stroke-width="15px" 
                      points="${top_left_x},${top_left_y}
                              ${top_right_x},${top_right_y}
                              ${bot_right_x},${bot_right_y}
                              ${bot_left_x},${bot_left_y}      " />`;
  return svg_outlines;
}

function pylonSide(a_polygon, poly_fill, panel_id, pylon_alive) {
  if (pylon_alive) {
    fill_color = poly_fill;
  } else {
    fill_color = 'black';
  }
  let [left_front_top, right_front_top, left_front_bot, right_front_bot] = a_polygon;
  let [top_left_x, top_left_y] = left_front_top;
  let [top_right_x, top_right_y] = right_front_top;
  let [bot_left_x, bot_left_y] = left_front_bot;
  let [bot_right_x, bot_right_y] = right_front_bot;
  svg_panel = `<polygon fill="${fill_color}" id="${panel_id}"
                      points="${top_left_x},${top_left_y}
                              ${top_right_x},${top_right_y}
                              ${bot_right_x},${bot_right_y}
                              ${bot_left_x},${bot_left_y}      " />`;
  return svg_panel;
}

function outlineWidth(difference_yy) {
  if (difference_yy < 8) {
    outline_width = 6;
  } else if (difference_yy < 16) {
    outline_width = 5.5;
  } else if (difference_yy < 24) {
    outline_width = 5;
  } else if (difference_yy < 32) {
    outline_width = 4.5;
  } else if (difference_yy < 40) {
    outline_width = 4;
  } else if (difference_yy < 100) {
    outline_width = 3.5;
  } else if (difference_yy < 200) {
    outline_width = 3;
  } else if (difference_yy < 300) {
    outline_width = 2.5;
  } else if (difference_yy < 400) {
    outline_width = 2;
  } else if (difference_yy < 500) {
    outline_width = 1.5;
  } else if (difference_yy < 600) {
    outline_width = 1;
  } else if (difference_yy < 700) {
    outline_width = 0.5;
  } else {
    outline_width = 0;
  }
  outline_adjusted = outline_width * PYLON_OUTLINE_ADJUST;
  return outline_adjusted;
}